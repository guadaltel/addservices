!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t){e.exports='<div class="m-control m-addservices-container">\n    <div id="m-searching-result-addservices" class="m-searching-result g-cartografia-spinner"></div>\n    <div class="title">Cargar servicios WMS</div>\n    \x3c!--         <div id="m-addservices-search" class="search-panel form">\n            <input id="m-addservice-url" type="text" placeholder="URL del servicio" />\n            <button id="m-addservices-btnurl" class="g-cartografia-mas2" title="Añadir WMS"></button>\n        </div> --\x3e\n    \x3c!-- search panel --\x3e\n    <div class="search-panel">\n        <input type="text" id="m-addservices-search-input" placeholder="URL del servicio" class="m-input-search" />\n        <button id="m-addservices-search-btn" class="g-cartografia-zoom m-search-btn" title="Conectar al servicio WMS"></button>\n        <button id="m-addservices-clear-btn" class="g-cartografia-cancelar m-clear-btn" title="Limpiar búsqueda"></button>\n    </div>\n    <div id="m-addservices-results"></div>\n</div>'},function(e,t){e.exports='<div class="results-panels">\n    <div class="table-results">\n        <table>\n            <thead>\n                <tr>\n                    <th>Capa</th>\n                    <th id="m-addservices-selectall">Seleccionar todas</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{#each result}}\n                    <tr>\n                        <td>{{name}}</td>\n                        <td><span id={{name}} class="m-check-addservices g-cartografia-check2"></span></td>\n                    </tr>\n                {{/each}}\n            </tbody>\n        </table>\n        <div class="button">\n            <button class="m-addservices-add"><i class="g-cartografia-subir"></i>Añadir</button>\n        </div>\n    </div>\n</div>'},function(e){e.exports={url:{name:"AddServices",separator:"*"},constructor:"M.plugin.AddServices",parameters:[],files:{ol:{scripts:"addservices.ol.min.js",styles:"addservices.ol.min.css"}},metadata:{name:"AddServices",description:"Añade servicio WMS",text:"Añade un capa desde un servicio WMS",version:"1.0.0",date:"Diciembre, 2019",author:"",org:"Consejería de Medioambiente y Ordenación del Territorio de la Junta de Andalucía",tags:"mapea,plugin",icon:"./facade/assets/icons/icons.svg"}}},function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(3);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,c(t).apply(this,arguments))}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,M.impl.Control),r=t,(n=[{key:"addTo",value:function(e,r){this.facadeMap=e,a(c(t.prototype),"addTo",this).call(this,e,r)}},{key:"destroy",value:function(){this.facadeMap.getMapImpl().removeControl(this)}}])&&i(r.prototype,n),l&&i(r,l),t}(),u=r(0),d=r.n(u),f=r(1),p=r.n(f);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(l)&&M.exception("La implementación usada no puede crear controles AddServicesControl");var r=new l;return(e=y(this,b(t).call(this,r,"AddServices"))).stateSelectAll=!1,e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,M.Control),r=t,(n=[{key:"addEvents",value:function(e){var t=this;this.urlService=e.querySelector("#m-addservices-search-input"),this.btnAddUrl=e.querySelector("#m-addservices-search-btn"),this.btnClear=e.querySelector("#m-addservices-clear-btn"),this.containerAddservices=e,this.containerSearching=e.querySelector("#m-searching-result-addservices"),this.containerResults=e.querySelector("#m-addservices-results"),this.containerSearch=e.querySelector("#m-addservices-search"),this.btnAddUrl.addEventListener("click",function(e){return t.readCapabilities(e)}),this.btnClear.addEventListener("click",function(e){return t.removeContains(e)})}},{key:"createView",value:function(e){var t=this;return this.facadeMap=e,new Promise(function(e,r){var n=M.template.compileSync(d.a);t.addEvents(n),e(n)})}},{key:"readCapabilities",value:function(e){var t=this;e.preventDefault(),M.utils.isNullOrEmpty(this.urlService.value)?M.dialog.error("Los campos están vacíos."):M.utils.isUrl(this.urlService.value)?(this.containerAddservices.classList.add("m-searching"),M.remote.get(M.utils.getWMSGetCapabilitiesUrl(this.urlService.value)).then(function(e){try{var r=(new M.impl.format.WMSCapabilities).read(e.xml),n=new M.impl.GetCapabilities(r,t.urlService.value,t.facadeMap.getProjection().code);t.capabilities=n.getLayers(),t.showResults()}catch(e){M.dialog.error("Ha ocurrido un error al obtener el documento GetCapabilities.")}t.containerAddservices.classList.remove("m-searching")})):M.dialog.error("Debes indicar una URL válida.")}},{key:"showResults",value:function(){var e=this,t=[];this.capabilities.forEach(function(e){t.push(e.getImpl())});var r=M.template.compileSync(p.a,{vars:{result:t}});this.containerResults.innerHTML=r.innerHTML,M.utils.enableTouchScroll(this.containerResults);for(var n=this.containerResults.getElementsByTagName("span"),i=0;i<n.length;i+=1)n[i].addEventListener("click",function(t){return e.registerCheck(t)});this.containerResults.querySelector("#m-addservices-selectall").addEventListener("click",function(t){return e.registerCheck(t)}),this.containerResults.querySelector(".m-addservices-add").addEventListener("click",function(t){return e.addLayers(t)})}},{key:"registerCheck",value:function(e){var t=e||window.event;!M.utils.isNullOrEmpty(t.target)&&t.target.classList.contains("m-check-addservices")?(t.stopPropagation(),t.target.classList.toggle("g-cartografia-check2"),t.target.classList.toggle("g-cartografia-check3"),this.containerResults.querySelectorAll(".g-cartografia-check3").length?this.containerResults.querySelectorAll(".g-cartografia-check2").length||(this.stateSelectAll=!0):this.stateSelectAll=!1):M.utils.isNullOrEmpty(t.target)||"m-addservices-selectall"!==t.target.id||(this.stateSelectAll?(this.unSelect(),this.stateSelectAll=!1):(this.select(),this.stateSelectAll=!0))}},{key:"unSelect",value:function(){for(var e=this.containerResults.querySelectorAll(".g-cartografia-check3"),t=0;t<e.length;t+=1)e[t].classList.remove("g-cartografia-check3"),e[t].classList.add("g-cartografia-check2")}},{key:"select",value:function(){for(var e=this.containerResults.querySelectorAll(".g-cartografia-check2"),t=0;t<e.length;t+=1)e[t].classList.remove("g-cartografia-check2"),e[t].classList.add("g-cartografia-check3")}},{key:"addLayers",value:function(e){e.preventDefault();var t=[],r=this.containerResults.querySelectorAll(".g-cartografia-check3");if(0===r.length)M.dialog.error("Debes seleccionar al menos una capa.");else{for(var n=0;n<r.length;n+=1)for(var i=0;i<this.capabilities.length;i+=1)r[n].id===this.capabilities[i].legend.replace(/ /g,"")&&(this.capabilities[i].options.origen="WMS",t.push(this.capabilities[i]));this.facadeMap.addLayers(t)}}},{key:"removeContains",value:function(e){e.preventDefault(),this.containerResults.innerHTML="",this.urlService.value=""}},{key:"equals",value:function(e){return e instanceof t}}])&&h(r.prototype,n),i&&h(r,i),t}(),S=r(2);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=O(this,k(t).call(this))).map_=null,r.controls_=[],r.metadata_=S.metadata,r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,M.Plugin),r=t,(n=[{key:"addTo",value:function(e){var t=this,r=new g;r.on(M.evt.ADDED_TO_MAP,function(){t.fire(M.evt.ADDED_TO_MAP)}),this.controls_.push(r),this.map_=e,this.panel_=new M.ui.Panel("panelAddServices",{collapsible:!0,className:"m-addservices",collapsedButtonClass:"g-cartografia-capas",position:M.ui.position.TR,tooltip:"Cargar WMS"}),this.panel_.addControls(this.controls_),this.map_.addPanels(this.panel_)}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_);var e=[null,null,null];this.map_=e[0],this.controls_=e[1],this.panel_=e[2]}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"name",get:function(){return"addservices"}}])&&_(r.prototype,n),i&&_(r,i),t}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.AddServices=j,window.M.control.AddServicesControl=g,window.M.impl.control.AddServicesControl=l}]);
//# sourceMappingURL=addservices.ol.min.js.map